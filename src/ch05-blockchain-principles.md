# 第5章 區塊鏈的技術原理

本章重點是從 Ethereum 視角理解現代區塊鏈系統，並掌握主流共識與技術演進方向。

## 5.1 以太坊詳解 `P0`

### 5.1.1 以太坊概述 `P0`
以太坊是通用智能合約平台，核心能力：
- EVM 執行環境
- 帳戶模型（EOA/Contract）
- Gas 計費機制
- 開放標準（ERC）

工程定位：適合快速組合 DeFi/NFT/治理應用。

### 5.1.2 智能合約 `P0`
智能合約是鏈上狀態機：
- 狀態（storage）
- 轉移函數（function）
- 外部觀測（event）

風險面：
- 不可逆部署
- 外部調用風險
- 升級與權限治理

### 5.1.3 外部帳戶與合約帳戶 `P0`
- EOA：私鑰控制，主動發起交易
- Contract Account：程式碼控制，被交易或合約調用觸發

工程差異：
- EOA 有 nonce
- 合約無私鑰，只能按程式規則執行

### 5.1.4 世界狀態樹 `P0`
以太坊主要樹結構：
- State Trie：帳戶狀態
- Transactions Trie：區塊交易
- Receipts Trie：交易結果

作用：
- 狀態可驗證
- 區塊摘要可快速校驗

### 5.1.5 以太坊經濟體 `P0`
經濟結構關鍵：
- EIP-1559：base fee + priority fee
- PoS 質押與懲罰
- MEV 對排序與收益分配的影響

工程要點：
- 交易策略需適配動態費率
- 高價值交易需防 MEV 與重排

## 5.2 區塊鏈的共識演算法 `P0`

### 5.2.1 PoS原理 `P0`
PoS 由質押權益決定提議/驗證權：
- 誠實參與獲得收益
- 惡意行為可被 slash

優點：低能源消耗、最終性更快。

### 5.2.2 DPoS原理 `P1`
DPoS 透過持幣人投票選出代表節點。

優點：性能與治理效率高。
代價：權力更集中，治理博弈更明顯。

### 5.2.3 PBFT原理 `P1`
PBFT 適合節點數較少、身份可管理場景（常見於聯盟鏈）。

特點：
- 快速確定性最終性
- 通訊複雜度較高

## 5.3 區塊鏈的技術方向

### 5.3.1 跨鏈 `P0`
跨鏈核心是「在鏈 A 驗證鏈 B 的事件」：
- 鎖鑄（lock-mint）
- 燒釋（burn-release）
- 訊息橋（message bridge）

安全重點：
- 驗證者模型
- 最終性假設
- 重放與重組處理

### 5.3.2 同態加密 `P1`
同態加密允許在密文上計算，潛力在隱私計算與機構協作。

限制：
- 計算與延遲成本高
- 通用場景尚需工程折衷

### 5.3.3 零知識證明 `P0`
ZK 用於「證明我知道答案且答案正確，但不暴露細節」。

主流方向：
- zk-SNARK
- zk-STARK

工程用途：
- L2 validity proof
- 隱私轉帳
- 身份最小揭露

### 5.3.4 二層網絡（Layer2） `P0`
L2 目標：降低費用、提高吞吐，同時繼承 L1 安全。

主流：
- Optimistic Rollup
- ZK Rollup

```text
User Tx -> L2 Sequencer -> Batch/Proof -> L1 Settlement
```

### 5.3.5 NFT `P1`
NFT 是非同質資產標準化表達：
- ERC-721（單一資產）
- ERC-1155（多資產混合）

工程重點：
- metadata 存儲策略（鏈上/鏈下）
- 版權與授權模型
- 市場流動性與洗售風險

## 本章總結
- Ethereum 提供了可程式化金融基座
- 共識機制決定了安全與性能上限
- 跨鏈、ZK、L2 是未來幾年的核心主線
