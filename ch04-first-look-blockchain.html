<!DOCTYPE HTML>
<html lang="zh-TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>第4章 初識區塊鏈 - 工程師等級 Web3 系統全圖（完整版）</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">工程師等級 Web3 系統全圖（完整版）</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="第4章-初識區塊鏈"><a class="header" href="#第4章-初識區塊鏈">第4章 初識區塊鏈</a></h1>
<p>本章聚焦於區塊鏈最底層共識與資料結構，目標是建立可實作的工程理解。</p>
<h2 id="41-區塊鏈的誕生與發展-p1"><a class="header" href="#41-區塊鏈的誕生與發展-p1">4.1 區塊鏈的誕生與發展 <code>P1</code></a></h2>
<h3 id="411-區塊鏈的誕生-p1"><a class="header" href="#411-區塊鏈的誕生-p1">4.1.1 區塊鏈的誕生 <code>P1</code></a></h3>
<p>區塊鏈誕生的核心背景是：</p>
<ul>
<li>中心化系統容易形成單點故障與信任成本</li>
<li>網路原生資產需要「不靠中心機構」的記帳方式</li>
<li>雙花問題需要在開放網路中可被驗證地解決</li>
</ul>
<p>工程結論：區塊鏈不是單一技術，而是密碼學、分散式網路、經濟激勵三者結合。</p>
<h3 id="412-認識密碼龐克組織-p1"><a class="header" href="#412-認識密碼龐克組織-p1">4.1.2 認識密碼龐克組織 <code>P1</code></a></h3>
<p>密碼龐克（Cypherpunk）核心理念：</p>
<ul>
<li>以密碼學工具保護個體自由</li>
<li>系統要「最小信任」而非「善意假設」</li>
<li>協議透明、程式可驗證</li>
</ul>
<p>對工程的直接影響：</p>
<ul>
<li>預設 hostile environment</li>
<li>重要規則寫進協議而非寫在文件</li>
<li>採用可公開審計的安全模型</li>
</ul>
<h3 id="413-區塊鏈技術的高速發展-p1"><a class="header" href="#413-區塊鏈技術的高速發展-p1">4.1.3 區塊鏈技術的高速發展 <code>P1</code></a></h3>
<p>發展主軸：</p>
<ul>
<li>Bitcoin：價值轉移與 PoW 安全</li>
<li>Ethereum：可程式化狀態與合約平台</li>
<li>L2：擴容與低成本</li>
<li>ZK/模組化：可驗證計算與分層架構</li>
</ul>
<h2 id="42-p2p網絡-p0"><a class="header" href="#42-p2p網絡-p0">4.2 P2P網絡 <code>P0</code></a></h2>
<h3 id="421-p2p網絡概述-p0"><a class="header" href="#421-p2p網絡概述-p0">4.2.1 P2P網絡概述 <code>P0</code></a></h3>
<p>P2P 網路特徵：</p>
<ul>
<li>無中心主機，節點對等交換資料</li>
<li>新交易/新區塊透過 gossip 擴散</li>
<li>每節點只需連少量鄰居即可參與全網同步</li>
</ul>
<pre><code class="language-text">peer A &lt;-&gt; peer B &lt;-&gt; peer C
   |         |         |
peer D &lt;-&gt; peer E &lt;-&gt; peer F
</code></pre>
<h3 id="422-p2p網絡的搭建重點-p0"><a class="header" href="#422-p2p網絡的搭建重點-p0">4.2.2 P2P網絡的搭建重點 <code>P0</code></a></h3>
<p>搭建重點：</p>
<ul>
<li>節點發現：seed/bootnode/mDNS</li>
<li>連線治理：限速、黑名單、重試退避</li>
<li>訊息設計：消息類型、版本協商、校驗碼</li>
<li>韌性策略：避免 eclipse attack、避免單點 seed</li>
</ul>
<h3 id="423-區塊鏈網絡的資料同步機制-p0"><a class="header" href="#423-區塊鏈網絡的資料同步機制-p0">4.2.3 區塊鏈網絡的資料同步機制 <code>P0</code></a></h3>
<p>資料同步常見流程：</p>
<ol>
<li>節點互報高度與 tip hash</li>
<li>缺塊節點請求區塊清單</li>
<li>逐塊拉取並驗證</li>
<li>更新本地鏈狀態與交易池</li>
</ol>
<p>工程要點：</p>
<ul>
<li>交易池去重</li>
<li>區塊驗證先於入庫</li>
<li>fork 時保留分叉資料以便重組</li>
</ul>
<h2 id="43-區塊鏈的資料結構-p0"><a class="header" href="#43-區塊鏈的資料結構-p0">4.3 區塊鏈的資料結構 <code>P0</code></a></h2>
<h3 id="431-哈希函數-p0"><a class="header" href="#431-哈希函數-p0">4.3.1 哈希函數 <code>P0</code></a></h3>
<p>hash 函數在鏈中用途：</p>
<ul>
<li>交易 ID</li>
<li>區塊 ID</li>
<li>Merkle 根</li>
<li>狀態承諾</li>
</ul>
<p>工程原則：</p>
<ul>
<li>序列化必須穩定</li>
<li>hash 算法版本變更要有兼容策略</li>
</ul>
<h3 id="432-時序的鏈塊式結構-p0"><a class="header" href="#432-時序的鏈塊式結構-p0">4.3.2 時序的鏈塊式結構 <code>P0</code></a></h3>
<p>區塊透過 <code>prev_block_hash</code> 串連，形成時間順序。
任一歷史區塊被改動，都會破壞後續鏈接校驗。</p>
<pre><code class="language-text">genesis -&gt; block1 -&gt; block2 -&gt; block3 -&gt; tip
</code></pre>
<h3 id="433-梅克爾樹-p0"><a class="header" href="#433-梅克爾樹-p0">4.3.3 梅克爾樹 <code>P0</code></a></h3>
<p>Merkle Tree 解決兩件事：</p>
<ul>
<li>大量交易的摘要承諾</li>
<li>只用路徑證明即可驗證交易包含性</li>
</ul>
<p>常見坑：</p>
<ul>
<li>奇數葉節點複製規則未統一</li>
<li>葉節點 hash 前處理不一致</li>
</ul>
<h2 id="44-pow機制-p0"><a class="header" href="#44-pow機制-p0">4.4 PoW機制 <code>P0</code></a></h2>
<h3 id="441-分佈式網絡中共識的意義-p0"><a class="header" href="#441-分佈式網絡中共識的意義-p0">4.4.1 分佈式網絡中共識的意義 <code>P0</code></a></h3>
<p>共識要回答：</p>
<ul>
<li>哪筆交易先發生</li>
<li>哪個區塊是有效延伸</li>
<li>網路分割後如何收斂到單一歷史</li>
</ul>
<h3 id="442-什麼是pow-p0"><a class="header" href="#442-什麼是pow-p0">4.4.2 什麼是PoW <code>P0</code></a></h3>
<p>PoW：透過計算成本取得出塊權。
有效區塊條件：<code>hash(header) &lt; target</code>。</p>
<h3 id="443-pow的本質原理-p0"><a class="header" href="#443-pow的本質原理-p0">4.4.3 PoW的本質原理 <code>P0</code></a></h3>
<p>本質是「用客觀成本限制作惡」：</p>
<ul>
<li>想改歷史要重做工作量</li>
<li>攻擊成本與鏈安全預算相關</li>
</ul>
<p>工程觀點：</p>
<ul>
<li>PoW 提供機率最終性</li>
<li>大額交易要提高確認數</li>
</ul>
<h2 id="45-utxo與交易-p0"><a class="header" href="#45-utxo與交易-p0">4.5 UTXO與交易 <code>P0</code></a></h2>
<h3 id="451-什麼是utxo-p0"><a class="header" href="#451-什麼是utxo-p0">4.5.1 什麼是UTXO <code>P0</code></a></h3>
<p>UTXO 是尚未花費輸出。
交易透過消耗舊輸出、創建新輸出完成轉移。</p>
<h3 id="452-比特幣交易模型-p0"><a class="header" href="#452-比特幣交易模型-p0">4.5.2 比特幣交易模型 <code>P0</code></a></h3>
<p>基本結構：</p>
<ul>
<li>Inputs：引用前序輸出</li>
<li>Outputs：新輸出（收款 + 找零）</li>
<li>Fee：輸入總額減輸出總額</li>
</ul>
<pre><code class="language-text">old outputs -&gt; tx inputs -&gt; validation -&gt; tx outputs
</code></pre>
<h3 id="453-交易腳本-p0"><a class="header" href="#453-交易腳本-p0">4.5.3 交易腳本 <code>P0</code></a></h3>
<p>腳本負責定義「誰能花這筆錢」：</p>
<ul>
<li>locking script（鎖定條件）</li>
<li>unlocking witness/script（解鎖證明）</li>
</ul>
<p>工程重點：</p>
<ul>
<li>支援常見模板（P2PKH/P2WPKH/P2TR）</li>
<li>驗證失敗要可追蹤錯誤原因</li>
</ul>
<h2 id="46-區塊鏈帳本的安全與挑戰-p0"><a class="header" href="#46-區塊鏈帳本的安全與挑戰-p0">4.6 區塊鏈帳本的安全與挑戰 <code>P0</code></a></h2>
<h3 id="461-雙花攻擊-p0"><a class="header" href="#461-雙花攻擊-p0">4.6.1 雙花攻擊 <code>P0</code></a></h3>
<p>同一資產被提交兩筆互斥交易。
防護：</p>
<ul>
<li>UTXO/nonce 檢查</li>
<li>足夠確認數</li>
<li>高風險交易延遲出貨</li>
</ul>
<h3 id="462-51攻擊-p0"><a class="header" href="#462-51攻擊-p0">4.6.2 51%攻擊 <code>P0</code></a></h3>
<p>若攻擊者控制多數算力/權益，可提高重組與審查能力。
防護：</p>
<ul>
<li>提升經濟安全（算力/質押分散）</li>
<li>增加確認數策略</li>
<li>監控異常重組</li>
</ul>
<h3 id="463-激勵相容-p0"><a class="header" href="#463-激勵相容-p0">4.6.3 激勵相容 <code>P0</code></a></h3>
<p>協議應讓誠實行為獲得最大期望收益。</p>
<p>工程檢核：</p>
<ul>
<li>出塊獎勵與費率模型是否合理</li>
<li>作惡成本是否高於收益</li>
<li>懲罰機制是否可執行</li>
</ul>
<h2 id="本章總結"><a class="header" href="#本章總結">本章總結</a></h2>
<p>本章最重要的是三條線：</p>
<ul>
<li>結構線：hash + 鏈塊 + Merkle</li>
<li>網路線：P2P 傳播與同步</li>
<li>共識線：PoW + 激勵 + 安全邊界</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="part-2-blockchain-tech.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch05-blockchain-principles.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="part-2-blockchain-tech.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch05-blockchain-principles.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
