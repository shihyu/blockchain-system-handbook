<!DOCTYPE HTML>
<html lang="zh-TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>第3章 區塊鏈原理、發展與應用 - 工程師等級 Web3 系統全圖（完整版）</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">工程師等級 Web3 系統全圖（完整版）</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="第3章-區塊鏈原理發展與應用"><a class="header" href="#第3章-區塊鏈原理發展與應用">第3章 區塊鏈原理、發展與應用</a></h1>
<p>本章目標是建立能落地開發的底層心智模型：你要知道鏈為何存在、如何達成一致、資料怎麼驗證、系統如何選型。</p>
<h2 id="31-區塊鏈基本原理"><a class="header" href="#31-區塊鏈基本原理">3.1 區塊鏈基本原理</a></h2>
<h3 id="311-區塊鏈技術為什麼會產生-p0"><a class="header" href="#311-區塊鏈技術為什麼會產生-p0">3.1.1 區塊鏈技術為什麼會產生 <code>P0</code></a></h3>
<p>在傳統中心化系統裡，資料正確性來自單一權威（銀行、平台、政府資料庫）。
區塊鏈的核心問題是：</p>
<ul>
<li>如果沒有中心機構，如何讓所有節點相信「同一本帳」？</li>
<li>如果人人可發交易，如何防止同一筆資產被重複花費（雙花）？</li>
</ul>
<p>工程上可把區塊鏈理解為三件事的組合：</p>
<ol>
<li><code>資料結構</code>：用 hash 鏈接區塊，保證歷史難以篡改。</li>
<li><code>網路協議</code>：用 P2P 傳播交易與區塊。</li>
<li><code>共識機制</code>：決定哪條鏈是全網接受的正確歷史。</li>
</ol>
<h3 id="312-什麼是-hash-函數-p0"><a class="header" href="#312-什麼是-hash-函數-p0">3.1.2 什麼是 hash 函數 <code>P0</code></a></h3>
<p>hash 函數把任意長度輸入映射成固定長度輸出，典型特性：</p>
<ul>
<li>不可逆：難以從 hash 反推出原文</li>
<li>抗碰撞：難找兩份不同資料得到同 hash</li>
<li>雪崩效應：輸入改一點，輸出大幅改變</li>
</ul>
<p>在區塊鏈中，hash 用於：</p>
<ul>
<li>交易 ID</li>
<li>區塊 ID</li>
<li>區塊鏈接（前一區塊 hash）</li>
<li>Merkle Root（交易集合摘要）</li>
</ul>
<p>Go 實作要點：</p>
<ul>
<li>使用 <code>crypto/sha256</code></li>
<li>輸入要先序列化成穩定格式</li>
<li>相同資料必須得到相同 hash</li>
</ul>
<pre><code class="language-go">sum := sha256.Sum256(data)
hexID := hex.EncodeToString(sum[:])
</code></pre>
<p>常見坑：</p>
<ul>
<li>直接 <code>fmt.Sprintf</code> 拼字串做 hash，格式不穩定</li>
<li>忘記固定欄位順序導致 hash 不一致</li>
</ul>
<h3 id="313-p2p-網絡簡介-p0"><a class="header" href="#313-p2p-網絡簡介-p0">3.1.3 P2P 網絡簡介 <code>P0</code></a></h3>
<p>P2P 是節點對等連線：每個節點同時是 client 與 server。</p>
<p>最小網路流程：</p>
<ol>
<li>節點發現（bootstrap / DNS / seed）</li>
<li>建立連線（TCP/QUIC）</li>
<li>握手（版本、鏈高度、能力）</li>
<li>訊息傳播（交易、區塊、請求/回應）</li>
</ol>
<pre><code class="language-text">Node A &lt;----&gt; Node B &lt;----&gt; Node C
   ^            |             |
   +------------+-------------+
</code></pre>
<p>Go 實作要點：</p>
<ul>
<li>先做單一消息協議（<code>version</code>, <code>inv</code>, <code>getdata</code>, <code>block</code>）</li>
<li>每個連線獨立 goroutine</li>
<li>設計 message envelope：<code>type + payload + checksum</code></li>
</ul>
<p>常見坑：</p>
<ul>
<li>沒有重放保護，收到同樣資料無限轉發</li>
<li>沒有節流，易被垃圾訊息打爆</li>
</ul>
<h3 id="314-pow-共識算法-p0"><a class="header" href="#314-pow-共識算法-p0">3.1.4 PoW 共識算法 <code>P0</code></a></h3>
<p>PoW（Proof of Work）透過計算成本競爭出塊權：</p>
<ul>
<li>礦工調整 nonce，尋找符合難度目標的 hash</li>
<li>全網接受「累積工作量最高」的鏈</li>
</ul>
<p>核心公式（概念）：</p>
<ul>
<li>找到 <code>hash(block_header) &lt; target</code></li>
<li><code>target</code> 越小，難度越高</li>
</ul>
<p>工程視角：</p>
<ul>
<li>PoW 提供的是機率最終性，不是絕對最終性</li>
<li>確認數越高，被回滾機率越低</li>
</ul>
<p>Go 實作要點：</p>
<ul>
<li>用 <code>math/big</code> 比較 hash 與 target</li>
<li>難度調整與區塊時間要解耦</li>
<li>驗證端一定要重算 header hash</li>
</ul>
<p>常見坑：</p>
<ul>
<li>只驗 nonce 不驗完整 header</li>
<li>難度固定不調整，導致出塊失衡</li>
</ul>
<h3 id="315-utxo-模型-p0"><a class="header" href="#315-utxo-模型-p0">3.1.5 UTXO 模型 <code>P0</code></a></h3>
<p>UTXO（未花費輸出）模型不是改餘額，而是消耗舊輸出、產生新輸出：</p>
<pre><code class="language-text">Inputs(引用舊UTXO) -&gt; Validation -&gt; Outputs(新UTXO + 找零)
</code></pre>
<p>交易費用：
<code>fee = sum(inputs) - sum(outputs)</code></p>
<p>為什麼 UTXO 重要：</p>
<ul>
<li>天然可追溯資產來源</li>
<li>不同 UTXO 可並行驗證</li>
<li>有利於審計與安全邊界設計</li>
</ul>
<p>Go 實作要點：</p>
<ul>
<li>建立 <code>TXInput</code>, <code>TXOutput</code>, <code>Transaction</code></li>
<li>維護 UTXO 集索引</li>
<li>coin selection 與 change address 分離</li>
</ul>
<p>常見坑：</p>
<ul>
<li>找零輸出漏建，資金等於白燒</li>
<li>多輸入簽名只簽了一部分輸入</li>
</ul>
<h2 id="32-區塊鏈發展歷程"><a class="header" href="#32-區塊鏈發展歷程">3.2 區塊鏈發展歷程</a></h2>
<h3 id="321-區塊鏈發展現狀-p1"><a class="header" href="#321-區塊鏈發展現狀-p1">3.2.1 區塊鏈發展現狀 <code>P1</code></a></h3>
<p>現況是多鏈並行：</p>
<ul>
<li>L1 提供安全與結算</li>
<li>L2 提供擴容與低費</li>
<li>應用端分化為 DeFi、支付、RWA、遊戲、社交</li>
</ul>
<h3 id="322-區塊鏈-20-時代-p1"><a class="header" href="#322-區塊鏈-20-時代-p1">3.2.2 區塊鏈 2.0 時代 <code>P1</code></a></h3>
<p>2.0 一般指智能合約時代：</p>
<ul>
<li>不只轉帳，而是鏈上程式</li>
<li>出現可組合協議（借貸、交易、衍生品）</li>
</ul>
<h3 id="323-區塊鏈行業未來展望-p1"><a class="header" href="#323-區塊鏈行業未來展望-p1">3.2.3 區塊鏈行業未來展望 <code>P1</code></a></h3>
<p>主要方向：</p>
<ul>
<li>ZK 証明普及</li>
<li>Account Abstraction 提升錢包 UX</li>
<li>合規與鏈上身份整合</li>
<li>跨鏈互操作標準化</li>
</ul>
<h2 id="33-區塊鏈開發技術選型"><a class="header" href="#33-區塊鏈開發技術選型">3.3 區塊鏈開發技術選型</a></h2>
<h3 id="331-dapp-架構分析-p0"><a class="header" href="#331-dapp-架構分析-p0">3.3.1 DApp 架構分析 <code>P0</code></a></h3>
<p>標準 DApp 分層：</p>
<pre><code class="language-text">Frontend -&gt; API/Backend -&gt; Wallet/Signer -&gt; RPC/Node -&gt; Smart Contract
                                     |
                                     +-&gt; Indexer/DB/Monitoring
</code></pre>
<p>選型檢查：</p>
<ul>
<li>鏈：成本、最終性、開發工具、生態流動性</li>
<li>節點：自建 + 第三方雙路</li>
<li>索引：即時查詢與歷史分析分離</li>
<li>風控：交易模擬、限額、名單、告警</li>
</ul>
<h3 id="332-公鏈與聯盟鏈之爭-p1"><a class="header" href="#332-公鏈與聯盟鏈之爭-p1">3.3.2 公鏈與聯盟鏈之爭 <code>P1</code></a></h3>
<ul>
<li>公鏈：開放、抗審查、治理慢</li>
<li>聯盟鏈：可控、性能高、信任假設較集中</li>
</ul>
<p>決策原則：</p>
<ul>
<li>對外資產流通與可組合性 -&gt; 公鏈優先</li>
<li>企業內部多方協作與合規 -&gt; 聯盟鏈可行</li>
</ul>
<h2 id="34-區塊鏈行業應用示例"><a class="header" href="#34-區塊鏈行業應用示例">3.4 區塊鏈行業應用示例</a></h2>
<h3 id="341-數字金融-p1"><a class="header" href="#341-數字金融-p1">3.4.1 數字金融 <code>P1</code></a></h3>
<ul>
<li>支付結算</li>
<li>借貸與抵押</li>
<li>資產代幣化</li>
</ul>
<h3 id="342-電子存證-p2"><a class="header" href="#342-電子存證-p2">3.4.2 電子存證 <code>P2</code></a></h3>
<ul>
<li>文件 hash 上鏈</li>
<li>時間戳與證據鏈</li>
</ul>
<h3 id="343-食品安全-p2"><a class="header" href="#343-食品安全-p2">3.4.3 食品安全 <code>P2</code></a></h3>
<ul>
<li>供應鏈節點上傳批次資料</li>
<li>以不可篡改日誌提供追溯</li>
</ul>
<h2 id="實訓區塊鏈理論在線-demo-演示-p1"><a class="header" href="#實訓區塊鏈理論在線-demo-演示-p1">實訓：區塊鏈理論在線 demo 演示 <code>P1</code></a></h2>
<p>建議做一個最小 demo：</p>
<ol>
<li>上傳一段文字，計算 hash</li>
<li>模擬打包到區塊，生成前後鏈接</li>
<li>模擬 PoW 挖礦（低難度）</li>
<li>模擬 UTXO 交易與找零</li>
</ol>
<p>驗收點：</p>
<ul>
<li>任意改動歷史交易會讓後續區塊校驗失敗</li>
<li>UTXO 花費後不可再次花費</li>
</ul>
<h2 id="本章總結"><a class="header" href="#本章總結">本章總結</a></h2>
<p>這章要記住的工程核心：</p>
<ul>
<li><code>hash</code> 解決資料完整性</li>
<li><code>P2P</code> 解決資料傳播</li>
<li><code>PoW/共識</code> 解決誰是正確歷史</li>
<li><code>UTXO</code> 解決價值轉移與可追蹤</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="part-4-go-practice.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="go-ch04-basic-dev.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="part-4-go-practice.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="go-ch04-basic-dev.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
